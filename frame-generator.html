<!DOCTYPE html>
<html lang="bn" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    
    <!-- Primary Meta Tags -->
    <title>‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶® | ‡¶Ü‡¶®‡ßã‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶õ‡¶ø‡¶¶‡ßç‡¶¶‡¶ø‡¶ï ‡¶ö‡ßå‡¶ß‡ßÅ‡¶∞‡ßÄ</title>
    <meta name="title" content="‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶® | ‡¶Ü‡¶®‡ßã‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶õ‡¶ø‡¶¶‡ßç‡¶¶‡¶ø‡¶ï ‡¶ö‡ßå‡¶ß‡ßÅ‡¶∞‡ßÄ">
    <meta name="description" content="‡¶¶‡¶æ‡¶Å‡ßú‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡ßü ‡¶≠‡ßã‡¶ü ‡¶¶‡¶ø‡¶® - ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü‡¶∞‡•§ ‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßá ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®, ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶ì ‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï‡ßá ‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®, ‡¶∏‡¶π‡¶ú ‡¶ì ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶‡¶≠‡¶æ‡¶¨‡ßá‡•§">
    <meta name="keywords" content="‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ, ‡¶≠‡ßã‡¶ü, ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂, ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶´‡ßç‡¶∞‡ßá‡¶Æ, ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶§‡ßà‡¶∞‡¶ø, ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶è‡¶°‡¶ø‡¶ü‡¶∞, ‡¶≠‡ßã‡¶ü ‡¶´‡ßç‡¶∞‡ßá‡¶Æ">
    <meta name="author" content="anwarsiddique.info.bd">
    <meta name="robots" content="index, follow">
    <meta name="language" content="Bengali">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="Pictorial Logo.png">
    <link rel="apple-touch-icon" href="Pictorial Logo.png">
    <link rel="shortcut icon" href="Pictorial Logo.png">
    
    <!-- Open Graph / Telegram / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://anwarsiddique.info.bd/frame-generator">
    <meta property="og:title" content="‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶® | ‡¶Ü‡¶®‡ßã‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶õ‡¶ø‡¶¶‡ßç‡¶¶‡¶ø‡¶ï ‡¶ö‡ßå‡¶ß‡ßÅ‡¶∞‡ßÄ">
    <meta property="og:description" content="‡¶¶‡¶æ‡¶Å‡ßú‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡ßü ‡¶≠‡ßã‡¶ü ‡¶¶‡¶ø‡¶® - ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü‡¶∞‡•§ ‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßá ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®, ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶ì ‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï‡ßá ‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®, ‡¶∏‡¶π‡¶ú ‡¶ì ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶‡¶≠‡¶æ‡¶¨‡ßá‡•§">
    <meta property="og:image" content="Pictorial Logo.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡¶Ø‡¶º ‡¶≠‡ßã‡¶ü ‡¶¶‡¶ø‡¶®">
    <meta property="og:locale" content="bn_BD">
    <meta property="og:site_name" content="‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://anwarsiddique.info.bd/frame-generator">
    <meta property="twitter:title" content="‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶® | ‡¶Ü‡¶®‡ßã‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶õ‡¶ø‡¶¶‡ßç‡¶¶‡¶ø‡¶ï ‡¶ö‡ßå‡¶ß‡ßÅ‡¶∞‡ßÄ">
    <meta property="twitter:description" content="‡¶¶‡¶æ‡¶Å‡ßú‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡ßü ‡¶≠‡ßã‡¶ü ‡¶¶‡¶ø‡¶® - ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü‡¶∞‡•§ ‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßá ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®, ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶ì ‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï‡ßá ‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®, ‡¶∏‡¶π‡¶ú ‡¶ì ‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶‡¶≠‡¶æ‡¶¨‡ßá‡•§">
    <meta property="twitter:image" content="Pictorial Logo.png">
    <meta property="twitter:image:alt" content="‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡¶Ø‡¶º ‡¶≠‡ßã‡¶ü ‡¶¶‡¶ø‡¶®">
    
    <!-- Additional SEO -->
    <meta name="theme-color" content="#16a34a">
    <meta name="msapplication-TileColor" content="#16a34a">
    <link rel="canonical" href="https://anwarsiddique.info.bd/frame-generator">
    
    <!-- Enhanced SEO Meta Tags -->
<meta name="keywords" content="‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ, ‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡¶Ø‡¶º ‡¶≠‡ßã‡¶ü ‡¶¶‡¶ø‡¶®, ‡¶Ü‡¶®‡ßã‡ßü‡¶æ‡¶∞ ‡¶õ‡¶ø‡¶¶‡ßç‡¶¶‡¶ø‡¶ï ‡¶ö‡ßå‡¶ß‡ßÅ‡¶∞‡ßÄ, ‡¶ú‡¶æ‡¶Æ‡¶æ‡¶Ø‡¶º‡¶æ‡¶§-‡¶á-‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßÄ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂, ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßÄ ‡¶Ü‡¶®‡ßç‡¶¶‡ßã‡¶≤‡¶® ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂, ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßÄ ‡¶∞‡¶æ‡¶ú‡¶®‡ßÄ‡¶§‡¶ø, ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶∞‡¶æ‡¶ú‡¶®‡ßÄ‡¶§‡¶ø, ‡¶≠‡ßã‡¶ü ‡¶´‡ßç‡¶∞‡ßá‡¶Æ, ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶´‡ßç‡¶∞‡ßá‡¶Æ, ‡¶õ‡¶¨‡¶ø ‡¶è‡¶°‡¶ø‡¶ü, ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü‡¶∞, ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®‡ßÄ ‡¶™‡ßç‡¶∞‡¶ö‡¶æ‡¶∞‡¶£‡¶æ, ‡¶ö‡¶ü‡ßç‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ-‡ß™ ‡¶Ü‡¶∏‡¶®, ‡¶∏‡¶Ç‡¶∏‡¶¶ ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶™‡ßç‡¶∞‡¶æ‡¶∞‡ßç‡¶•‡ßÄ, ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßÄ ‡¶∂‡¶æ‡¶∏‡¶®‡¶§‡¶®‡ßç‡¶§‡ßç‡¶∞, ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßÄ ‡¶∏‡¶Æ‡¶æ‡¶ú‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡ßç‡¶•‡¶æ">

<!-- Additional Structured Data for Google -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡¶Ø‡¶º ‡¶≠‡ßã‡¶ü ‡¶¶‡¶ø‡¶® - ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü‡¶∞",
  "description": "‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßÄ ‡¶∂‡¶æ‡¶∏‡¶®‡¶§‡¶®‡ßç‡¶§‡ßç‡¶∞‡ßá‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶§‡ßá ‡¶∞‡¶æ‡¶∑‡ßç‡¶ü‡ßç‡¶∞ ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶®‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ú‡¶æ‡¶Æ‡¶æ‡¶Ø‡¶º‡¶æ‡¶§-‡¶á-‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßÄ‡¶∞ ‡¶™‡ßç‡¶∞‡¶æ‡¶∞‡ßç‡¶•‡ßÄ ‡¶Ü‡¶®‡ßã‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶õ‡¶ø‡¶¶‡ßç‡¶¶‡¶ø‡¶ï ‡¶ö‡ßå‡¶ß‡ßÅ‡¶∞‡ßÄ‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®‡ßÄ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®‡•§",
  "url": "https://anwarsiddique.info.bd/frame-generator",
  "applicationCategory": "MultimediaApplication",
  "operatingSystem": "Any",
  "author": {
    "@type": "Organization",
    "name": "‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ"
  },
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "BDT"
  }
}

// Firebase configuration for visitor counter
const firebaseConfig = {
    apiKey: "AIzaSyB_EXAMPLE_KEY",
    authDomain: "daripalla-frame-generator.firebaseapp.com",
    databaseURL: "https://daripalla-frame-generator-default-rtdb.firebaseio.com",
    projectId: "daripalla-frame-generator",
    storageBucket: "daripalla-frame-generator.appspot.com",
    messagingSenderId: "1234567890",
    appId: "1:1234567890:web:abcdef1234567890"
};

// Initialize Firebase and visitor counter
let visitorCount = 0;
try {
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    const visitorRef = database.ref('visitors');
    
    // Get current visitor count
    visitorRef.once('value').then((snapshot) => {
        visitorCount = snapshot.val() || 0;
        document.getElementById('visitorCounter').textContent = 
            visitorCount.toLocaleString('bn-BD');
    });
    
    // Increment visitor count
    visitorRef.transaction((currentCount) => {
        return (currentCount || 0) + 1;
    });
} catch (error) {
    console.log('Firebase not configured, using mock visitor count');
    // Mock visitor count for demo
    const mockCount = Math.floor(Math.random() * 10000) + 5000;
    document.getElementById('visitorCounter').textContent = 
        mockCount.toLocaleString('bn-BD');
}

// Social Sharing Functions
function shareOnFacebook() {
    if (!userImageObj) {
        showToast('‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶õ‡¶¨‡¶ø ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®', 'error');
        return;
    }
    
    fabricCanvas.getElement().toBlob(function(blob) {
        const file = new File([blob], "daripalla_frame.png", {type: "image/png"});
        const formData = new FormData();
        formData.append('file', file);
        
        // Note: Facebook direct upload requires server-side implementation
        // For now, we'll use download and manual share
        showToast('‡¶õ‡¶¨‡¶ø ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡¶Ø‡¶º‡¶æ‡¶≤‡¶ø ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®', 'info');
        
        // Alternative: Open Facebook share dialog
        const shareURL = 'https://anwarsiddique.info.bd/frame-generator';
        const shareText = '‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡¶Ø‡¶º ‡¶≠‡ßã‡¶ü ‡¶¶‡¶ø‡¶® - ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßÄ ‡¶∂‡¶æ‡¶∏‡¶®‡¶§‡¶®‡ßç‡¶§‡ßç‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø';
        window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareURL)}&quote=${encodeURIComponent(shareText)}`, '_blank');
    });
}

function shareOnTwitter() {
    const shareText = '‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡¶Ø‡¶º ‡¶≠‡ßã‡¶ü ‡¶¶‡¶ø‡¶® - ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßÄ ‡¶∂‡¶æ‡¶∏‡¶®‡¶§‡¶®‡ßç‡¶§‡ßç‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø #‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ #‡¶ú‡¶æ‡¶Æ‡¶æ‡¶Ø‡¶º‡¶æ‡¶§ #‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßÄ_‡¶∂‡¶æ‡¶∏‡¶®‡¶§‡¶®‡ßç‡¶§‡ßç‡¶∞';
    const shareURL = 'https://anwarsiddique.info.bd/frame-generator';
    window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(shareURL)}`, '_blank');
}

// Image Effects Function
function applyEffect() {
    if (!userImageObj) {
        showToast('‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶õ‡¶¨‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®', 'error');
        return;
    }
    
    const effectType = document.getElementById('effectSelector').value;
    
    fabricCanvas.remove(userImageObj);
    
    // Apply selected effect
    const filters = [];
    switch(effectType) {
        case 'brightness':
            filters.push(new fabric.Image.filters.Brightness({ brightness: 0.1 }));
            break;
        case 'contrast':
            filters.push(new fabric.Image.filters.Contrast({ contrast: 0.1 }));
            break;
        case 'sepia':
            filters.push(new fabric.Image.filters.Sepia());
            break;
        case 'grayscale':
            filters.push(new fabric.Image.filters.Grayscale());
            break;
        default:
            // No effect
            break;
    }
    
    userImageObj.filters = filters;
    userImageObj.applyFilters();
    
    fabricCanvas.add(userImageObj);
    if (frameImageObj) {
        fabricCanvas.bringToFront(frameImageObj);
    }
    
    fabricCanvas.renderAll();
    showToast('‡¶á‡¶´‡ßá‡¶ï‡ßç‡¶ü ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!', 'success');
}

// Auto-save to localStorage
function autoSave() {
    if (userImageObj) {
        const state = {
            imageData: fabricCanvas.toDataURL(),
            zoom: zoomSlider.value,
            selectedFrame: currentFrame
        };
        localStorage.setItem('daripalla_frame_state', JSON.stringify(state));
    }
}

// Load auto-saved state
function loadSavedState() {
    const saved = localStorage.getItem('daripalla_frame_state');
    if (saved) {
        try {
            const state = JSON.parse(saved);
            if (state.imageData) {
                loadImage(state.imageData);
                setTimeout(() => {
                    zoomSlider.value = state.zoom;
                    handleZoom({target: zoomSlider});
                    
                    if (state.selectedFrame) {
                        document.querySelectorAll('.frame-option').forEach(el => {
                            if (el.dataset.frame === state.selectedFrame) {
                                selectFrame(el, state.selectedFrame);
                            }
                        });
                    }
                }, 500);
                
                showToast('‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∂‡ßá‡¶∑ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá', 'info');
            }
        } catch (e) {
            console.log('No saved state found');
        }
    }
}

// Enhanced initialization with auto-save
function enhancedInit() {
    init(); // Call original init
    
    // Load saved state
    setTimeout(loadSavedState, 1000);
    
    // Auto-save every 30 seconds
    setInterval(autoSave, 30000);
    
    // Auto-save on user actions
    ['click', 'touchmove', 'touchend'].forEach(event => {
        previewCanvas.addEventListener(event, () => {
            setTimeout(autoSave, 1000);
        });
    });
}

// Replace original init call
window.addEventListener('DOMContentLoaded', enhancedInit);

// Enhanced download with auto-increment filename
function enhancedDownloadImage() {
    if (!userImageObj) {
        showToast('‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶ó‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶õ‡¶¨‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'error');
        return;
    }

    showLoading(true);

    try {
        // Get download count
        let downloadCount = localStorage.getItem('daripalla_download_count') || 0;
        downloadCount = parseInt(downloadCount) + 1;
        localStorage.setItem('daripalla_download_count', downloadCount);
        
        // Update visitor counter locally
        visitorCount++;
        document.getElementById('visitorCounter').textContent = 
            visitorCount.toLocaleString('bn-BD');
        
        const filename = `‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ_‡¶´‡ßç‡¶∞‡ßá‡¶Æ_${downloadCount}_${Date.now()}.png`;
        
        const link = document.createElement('a');
        link.download = filename;
        link.href = fabricCanvas.toDataURL({ format: 'png', quality: 1 });
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);

        showToast(`‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®! ‡¶Æ‡ßã‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°: ${downloadCount}`, 'success');
    } catch (error) {
        console.error('Export error:', error);
        showToast('‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'error');
    } finally {
        showLoading(false);
    }
}

// Replace original download function
downloadBtn.removeEventListener('click', downloadImage);
downloadBtn.addEventListener('click', enhancedDownloadImage);
</script>

<!-- Person Schema for Anwar Siddique Chowdhury -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "‡¶Ü‡¶®‡ßã‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶õ‡¶ø‡¶¶‡ßç‡¶¶‡¶ø‡¶ï ‡¶ö‡ßå‡¶ß‡ßÅ‡¶∞‡ßÄ",
  "jobTitle": "‡¶∏‡¶Ç‡¶∏‡¶¶ ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶™‡ßç‡¶∞‡¶æ‡¶∞‡ßç‡¶•‡ßÄ",
  "description": "‡¶ö‡¶ü‡ßç‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ-‡ß™ ‡¶Ü‡¶∏‡¶®‡ßá‡¶∞ ‡¶ú‡¶æ‡¶Æ‡¶æ‡ßü‡¶æ‡¶§‡ßá ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßÄ ‡¶ì ‡ßß‡ßß ‡¶¶‡¶≤‡ßÄ‡ßü ‡¶ê‡¶ï‡ßç‡¶Ø‡¶¨‡¶¶‡ßç‡¶ß ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂-‡¶è‡¶∞ ‡¶™‡ßç‡¶∞‡¶æ‡¶∞‡ßç‡¶•‡ßÄ‡¶ï‡ßá ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßÄ ‡¶∂‡¶æ‡¶∏‡¶®, ‡¶®‡ßç‡¶Ø‡¶æ‡ßü ‡¶ì ‡¶á‡¶®‡¶∏‡¶æ‡¶´‡ßá‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶§‡ßá ‡¶∞‡¶æ‡¶∑‡ßç‡¶ü‡ßç‡¶∞ ‡¶™‡¶∞‡¶ø‡¶ö‡¶æ‡¶≤‡¶®‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡¶Ø‡¶º ‡¶≠‡ßã‡¶ü ‡¶¶‡¶ø‡¶®‡•§",
  "affiliation": {
    "@type": "Organization",
    "name": "‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶ú‡¶æ‡¶Æ‡¶æ‡ßü‡¶æ‡¶§‡ßá ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßÄ
  },
  "knowsAbout": ["‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßÄ ‡¶∞‡¶æ‡¶ú‡¶®‡ßÄ‡¶§‡¶ø", "‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßÄ ‡¶∏‡¶Æ‡¶æ‡¶ú‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡ßç‡¶•‡¶æ", "‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶∞‡¶æ‡¶ú‡¶®‡ßÄ‡¶§‡¶ø"],
  "url": "https://anwarsiddique.info.bd"
}
</script>

    <!-- Google Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Custom Fonts -->
    <style>
        @font-face {
            font-family: 'Shadhinata';
            src: url('Li Shadhinata 2.0 Unicode.ttf') format('truetype');
        }
        @font-face {
            font-family: 'Purno';
            src: url('BCC Purno Semibold.otf') format('opentype');
        }
        
        body {
            font-family: 'Purno', 'Hind Siliguri', sans-serif;
        }
        
        .font-shadhinata {
            font-family: 'Shadhinata', sans-serif;
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Shadhinata', sans-serif;
            font-weight: 700;
        }
    </style>
    
    <style>
        * {
            -webkit-tap-highlight-color: transparent;
        }
        
        /* Custom range slider */
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            background: #16a34a;
            height: 8px;
            border-radius: 4px;
            cursor: pointer;
            outline: none;
        }
        
        input[type="range"]::-webkit-slider-track {
            background: #16a34a;
            height: 8px;
            border-radius: 4px;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            background: #16a34a;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            margin-top: -6px;
        }
        
        input[type="range"]::-moz-range-track {
            background: #16a34a;
            height: 8px;
            border-radius: 4px;
        }
        
        input[type="range"]::-moz-range-thumb {
            background: #16a34a;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            cursor: pointer;
        }
        
        /* Preview canvas */
        #previewCanvas {
            width: 100% !important;
            height: 100% !important;
            max-width: 100%;
            display: block;
            touch-action: none;
        }
        
        /* Fabric.js canvas wrapper */
        .canvas-container {
            width: 100% !important;
            height: 100% !important;
            max-width: 100%;
            position: relative;
        }
        
        .canvas-container canvas {
            max-width: 100% !important;
            height: auto !important;
        }
        
        /* Frame option */
        .frame-option {
            position: relative;
            width: 100px;
            height: 100px;
            min-width: 100px;
            border-radius: 0.75rem;
            overflow: hidden;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.2s ease;
            background: #f3f4f6;
            touch-action: manipulation;
            flex-shrink: 0;
        }
        
        .frame-option:hover {
            transform: scale(1.05);
            border-color: #16a34a;
        }
        
        .frame-option:active {
            transform: scale(0.95);
        }
        
        .frame-option.selected {
            border-color: #D3342D;
            box-shadow: 0 0 0 3px rgba(211, 52, 45, 0.2);
        }
        
        .frame-option img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        /* Toast */
        .toast {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: rgba(15, 23, 42, 0.95);
            color: white;
            padding: 16px 24px;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
            font-size: 14px;
            font-weight: 600;
            z-index: 1000;
            max-width: 90%;
            transition: transform 0.3s ease;
        }
        
        .toast.show {
            transform: translateX(-50%) translateY(0);
        }
        
        .toast.error {
            background: rgba(220, 38, 38, 0.95);
        }
        
        .toast.success {
            background: rgba(34, 197, 94, 0.95);
        }
        
        /* Loading spinner */
        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        input[type="file"] {
            display: none;
        }
        
        /* Dark mode support */
        .dark .frame-option {
            background: #374151;
        }
        
        .dark input[type="range"] {
            background: #374151;
        }
        
        .dark input[type="range"]::-webkit-slider-track {
            background: #374151;
        }
        
        .dark input[type="range"]::-webkit-slider-thumb {
            background: #D3342D;
        }
        
        /* Mobile optimizations */
        @media (max-width: 640px) {
            .frame-option {
                width: 85px;
                height: 85px;
                min-width: 85px;
            }
        }
    </style>
    <style>
        /* Enhanced Mobile Responsiveness */
@media (max-width: 640px) {
    .frame-option {
        width: 75px;
        height: 75px;
        min-width: 75px;
    }
    
    .canvas-container canvas {
        max-width: 95vw !important;
        max-height: 95vw !important;
    }
    
    #previewContainer {
        width: 95vw;
        height: 95vw;
        margin: 0 auto;
    }
    
    h1 {
        font-size: 1.75rem !important;
        line-height: 2rem !important;
    }
    
    .grid-cols-1 {
        grid-template-columns: 1fr !important;
    }
    
    /* Mobile touch-friendly buttons */
    button, .frame-option, input[type="range"] {
        min-height: 44px; /* Apple's recommended touch target size */
    }
    
    .mobile-hidden {
        display: none !important;
    }
    
    .mobile-show {
        display: block !important;
    }
    
    /* Better spacing for mobile */
    .container {
        padding-left: 1rem !important;
        padding-right: 1rem !important;
    }
    
    /* Adjust font sizes for mobile */
    .text-sm-mobile {
        font-size: 0.875rem !important;
    }
    
    .text-base-mobile {
        font-size: 1rem !important;
    }
}

/* Tablet Responsiveness */
@media (min-width: 641px) and (max-width: 1024px) {
    .frame-option {
        width: 90px;
        height: 90px;
        min-width: 90px;
    }
    
    #previewContainer {
        width: 90vw;
        height: 90vw;
        max-width: 600px;
        margin: 0 auto;
    }
}

/* Prevent text selection on touch devices */
.no-select {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

/* Improved touch scrolling for frame selection */
#framesGrid {
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none; /* Firefox */
}

#framesGrid::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Opera */
}

/* Mobile loading optimization */
.mobile-loading {
    background-size: 50% auto;
}
    </style>

    <style>
        /* Enhanced Mobile Responsiveness */
@media (max-width: 640px) {
    .container {
        padding-left: 0.75rem !important;
        padding-right: 0.75rem !important;
    }
    
    .frame-option {
        width: 70px;
        height: 70px;
        min-width: 70px;
    }
    
    .aspect-square {
        aspect-ratio: 1 / 1;
    }
    
    /* Touch-friendly elements */
    button, .frame-option {
        min-height: 44px;
        -webkit-tap-highlight-color: rgba(211, 52, 45, 0.3);
    }
    
    input[type="range"] {
        min-height: 24px;
    }
    
    /* Hide scrollbar but keep functionality */
    .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }
    
    .scrollbar-hide::-webkit-scrollbar {
        display: none;
    }
    
    /* Better text readability */
    h1, h2, h3 {
        line-height: 1.2 !important;
    }
    
    /* Reduce spacing on mobile */
    .space-y-4 > * + * {
        margin-top: 1rem;
    }
}

@media (min-width: 641px) and (max-width: 768px) {
    .frame-option {
        width: 85px;
        height: 85px;
        min-width: 85px;
    }
    
    .container {
        padding-left: 1rem !important;
        padding-right: 1rem !important;
    }
}

/* Tablet Optimizations */
@media (min-width: 769px) and (max-width: 1024px) {
    .frame-option {
        width: 95px;
        height: 95px;
        min-width: 95px;
    }
    
    .grid-cols-2 {
        grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    }
}

/* Touch Manipulation */
.touch-manipulation {
    touch-action: manipulation;
}

/* Improve focus states for accessibility */
button:focus, 
.frame-option:focus,
input[type="range"]:focus {
    outline: 2px solid #D3342D;
    outline-offset: 2px;
}

/* Mobile-optimized canvas */
@media (max-width: 1024px) {
    #previewContainer {
        width: 100%;
        height: auto;
        max-width: 500px;
        margin: 0 auto;
    }
    
    #previewCanvas {
        touch-action: pan-x pan-y pinch-zoom;
    }
}
    </style>
    
    <!-- Fabric.js Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/4.6.0/fabric.min.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-analytics-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <style>
        /* Additional styles can go here */
    </style>
</head>
<body class="dark:bg-slate-900 dark:text-white bg-gray-50">
    
    <!-- Navigation Bar - Same as main site -->
    <nav id="navbar" class="fixed w-full z-50 transition-all duration-300 py-3 md:py-4 bg-white/95 dark:bg-slate-900/95 backdrop-blur-md shadow-lg border-b border-gray-200 dark:border-slate-800">
        <div class="container mx-auto px-4 md:px-6 flex justify-between items-center">
            <!-- Logo and Branding -->
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 md:w-12 md:h-12 rounded-full flex items-center justify-center shadow-lg overflow-hidden bg-transparent">
                    <img src="Logo_Big.gif" alt="Logo" class="w-full h-full object-cover">
                </div>
                <div class="hidden sm:block">
                    <p id="nav-name" class="font-light text-lg md:text-xl leading-none dark:text-white text-slate-900 transition-colors font-shadhinata">‡¶Ü‡¶®‡ßã‡ßü‡¶æ‡¶∞ ‡¶õ‡¶ø‡¶¶‡ßç‡¶¶‡¶ø‡¶ï ‡¶ö‡ßå‡¶ß‡ßÅ‡¶∞‡ßÄ</p>
                    <p id="nav-sub" class="text-[11px] md:text-[12px] font-light uppercase tracking-widest mt-0.5 dark:text-yellow-300 text-yellow-700 transition-colors">
                        ‡¶∏‡¶Ç‡¶∏‡¶¶ ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶™‡ßç‡¶∞‡¶æ‡¶∞‡ßç‡¶•‡ßÄ, ‡¶ö‡¶ü‡ßç‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ-‡ß™
                    </p>
                </div>
                
                <!-- Mobile Title -->
                <div class="sm:hidden">
                    <p id="nav-name" class="font-light text-sm leading-none dark:text-white text-slate-900 transition-colors font-shadhinata">‡¶Ü‡¶®‡ßã‡ßü‡¶æ‡¶∞ ‡¶õ‡¶ø‡¶¶‡ßç‡¶¶‡¶ø‡¶ï ‡¶ö‡ßå‡¶ß‡ßÅ‡¶∞‡ßÄ</p>
                    <p id="nav-sub" class="text-[10px] font-light uppercase tracking-widest mt-0.5 dark:text-yellow-300 text-yellow-700 transition-colors">
                        ‡¶∏‡¶Ç‡¶∏‡¶¶ ‡¶∏‡¶¶‡¶∏‡ßç‡¶Ø‡¶™‡ßç‡¶∞‡¶æ‡¶∞‡ßç‡¶•‡ßÄ, ‡¶ö‡¶ü‡ßç‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ-‡ß™
                    </p>
                </div>
            </div>

            <!-- Back to Home Button -->
            <div class="flex items-center gap-2">
                <a href="index.html" 
                   class="bg-gradient-to-r from-[#D3342D] to-red-600 px-4 md:px-6 py-2 md:py-3 rounded-full font-light text-white text-sm md:text-base shadow-xl hover:from-red-600 hover:to-[#D3342D] active:scale-95 transition-all whitespace-nowrap flex items-center gap-2">
                    <i class="fas fa-home"></i>
                    <span class="hidden sm:inline">‡¶Æ‡ßÇ‡¶≤ ‡¶™‡ßá‡¶á‡¶ú‡ßá ‡¶´‡¶ø‡¶∞‡ßÅ‡¶®</span>
                    <span class="sm:hidden">‡¶π‡ßã‡¶Æ</span>
                </a>
            </div>
        </div>
    </nav>

<!-- Main Content -->
<main class="pt-16 md:pt-20 lg:pt-24 pb-8 md:pb-12">
    <div class="container mx-auto px-3 md:px-4 lg:px-6">
        <!-- Header -->
        <div class="text-center mb-6 md:mb-8 lg:mb-12 px-2">
            <h1 class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-light mb-3 md:mb-4 dark:text-white text-slate-900 font-shadhinata leading-tight">
                ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®
            </h1>
            <p class="text-sm sm:text-base md:text-lg lg:text-xl dark:text-gray-300 text-gray-600 max-w-2xl mx-auto px-2">
                ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶õ‡¶¨‡¶ø‡¶§‡ßá "‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡¶Ø‡¶º ‡¶≠‡ßã‡¶ü ‡¶¶‡¶ø‡¶®" ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶Æ‡¶ø‡¶°‡¶ø‡¶Ø‡¶º‡¶æ‡¶Ø‡¶º ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®
            </p>
        </div>

    <!-- Frame Selector -->
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8">
        <div class="max-w-[575px] mx-auto">
            <!-- Frame Selector - Fixed at Top -->
            <div class="bg-green-950 rounded-2xl shadow-xl p-1 sm:p-6 mb-6 top-4 z-10 border border-gray-100">
                <h2 class="text-lg sm:text-xl font-light text-white mb-4">‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</h2>
                <div class="overflow-x-auto pb-2" style="scrollbar-width: thin;">
                    <div class="flex gap-4" id="framesGrid" style="min-width: max-content;"></div>
                </div>
            </div>
    
            <!-- Canvas Container -->
            <div class="bg-green-950 rounded-2xl shadow-xl p-4 sm:p-6 border border-gray-100 mb-6">
                <div class="relative w-full aspect-square rounded-xl overflow-hidden mb-4" id="previewContainer" style="background-color: #f5f5f5; background-image: linear-gradient(45deg, #e0e0e0 25%, transparent 25%), linear-gradient(-45deg, #e0e0e0 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #e0e0e0 75%), linear-gradient(-45deg, transparent 75%, #e0e0e0 75%); background-size: 20px 20px; background-position: 0 0, 0 10px, 10px -10px, -10px 0px;">
                    <canvas id="previewCanvas" width="1080" height="1080" style="touch-action: none; max-width: 100%; height: auto;"></canvas>
                    <div class="hidden absolute inset-0 bg-black bg-opacity-80 flex flex-col items-center justify-center text-white rounded-xl" id="loadingIndicator">
                        <div class="spinner mb-4"></div>
                        <div class="font-semibold">‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
                    </div>
                </div>
    
                <!-- Zoom Slider (Desktop Only) -->
                <div class="space-y-2 mb-4">
                    <label class="text-sm font-semibold text-white flex items-center gap-2">
                        <span>üîç</span>
                        <span>‡¶ú‡ßÅ‡¶Æ</span>
                    </label>
                    <div class="flex items-center gap-3">
                        <input type="range" id="zoomSlider" min="-100" max="200" value="0" class="flex-1" aria-label="‡¶ú‡ßÅ‡¶Æ ‡¶®‡¶ø‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£">
                        <span class="text-blue-300 font-bold min-w-[60px] text-center text-sm" id="zoomValue">0%</span>
                    </div>
                </div>
    
                <!-- Image Selection Button -->
                <div class="space-y-3">
                    <button type="button" class="w-full bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-bold py-3 px-6 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center gap-2" id="selectImageBtn">
                        <span class="text-xl">üì∏</span>
                        <span>‡¶õ‡¶¨‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</span>
                    </button>
                    <button type="button" class="w-full hidden bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold py-3 px-6 rounded-xl transition-all duration-200 flex items-center justify-center gap-2" id="changeImageBtn">
                        <span class="text-xl">üñºÔ∏è</span>
                        <span>‡¶õ‡¶¨‡¶ø ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</span>
                    </button>
                    <button type="button" class="w-full bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-bold py-4 px-6 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 transform hover:-translate-y-0.5 flex items-center justify-center gap-2" id="downloadBtn">
                        <span class="text-xl">üì•</span>
                        <span>‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°</span>
                    </button>
                </div>
            </div>
    
            <input type="file" id="fileInput" accept="image/*" aria-label="‡¶õ‡¶¨‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®" style="display: none;">
        </div>
    </div>

    </div>
</main>

        <!-- Feature Highlights Section -->
<section class="py-8 md:py-12 bg-gradient-to-b from-green-50 to-white dark:from-slate-800 dark:to-slate-900">
    <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8">
                        <!-- Feature 2: Social Share -->
            <div class="bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-lg border border-blue-100 dark:border-slate-700">
                <div class="flex items-center gap-4 mb-4">
                    <div class="w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center">
                        <i class="fas fa-share-alt text-blue-600 dark:text-blue-400 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-shadhinata">‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶Æ‡¶ø‡¶°‡¶ø‡¶Ø‡¶º‡¶æ‡¶Ø‡¶º ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
                </div>
                <div class="space-y-3">
                    <button onclick="shareOnFacebook()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg flex items-center justify-center gap-2 transition-all">
                        <i class="fab fa-facebook-f"></i>
                        <span>‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï‡ßá ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®</span>
                    </button>
                    <button onclick="shareOnTwitter()" class="w-full bg-sky-500 hover:bg-sky-600 text-white py-2 px-4 rounded-lg flex items-center justify-center gap-2 transition-all">
                        <i class="fab fa-twitter"></i>
                        <span>‡¶ü‡ßÅ‡¶á‡¶ü‡¶æ‡¶∞‡ßá ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®</span>
                    </button>
                </div>
            </div>
            
            <!-- Feature 1: Visitor Counter -->
            <div class="bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-lg border border-green-100 dark:border-slate-700">
                <div class="flex items-center gap-4 mb-4">
                    <div class="w-12 h-12 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center">
                        <i class="fas fa-users text-green-600 dark:text-green-400 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-shadhinata">‡¶ü‡ßã‡¶ü‡¶æ‡¶≤ ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü‡¶∞</h3>
                </div>
                <div class="text-center">
                    <div id="visitorCounter" class="text-4xl md:text-5xl font-bold text-green-600 dark:text-green-400 mb-2">‡ß¶</div>
                    <p class="text-sm text-gray-600 dark:text-gray-400">‡¶ú‡¶æ‡¶®‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø ‡ß®‡ß¶‡ß®‡ß¨ ‡¶•‡ßá‡¶ï‡ßá</p>
                </div>
            </div>

            <!-- Feature Highlights Section ‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶® -->
<div class="bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-lg border border-green-100 dark:border-slate-700">
    <div class="flex items-center gap-4 mb-4">
        <div class="w-12 h-12 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center">
            <i class="fas fa-download text-green-600 dark:text-green-400 text-xl"></i>
        </div>
        <h3 class="text-xl font-shadhinata">‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶®</h3>
    </div>
    <div class="text-center space-y-4">
        <!-- ‡¶Æ‡ßã‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° -->
        <div>
            <div class="text-3xl md:text-4xl font-bold text-green-600 dark:text-green-400 mb-1" id="downloadCounter">‡ß¶</div>
            <p class="text-sm text-gray-600 dark:text-gray-400">‡¶Æ‡ßã‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°</p>
        </div>
        
        <!-- ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° -->
        <div>
            <div class="text-2xl md:text-3xl font-bold text-blue-600 dark:text-blue-400 mb-1" id="todayDownloads">‡ß¶</div>
            <p class="text-sm text-gray-600 dark:text-gray-400">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°</p>
        </div>
        
        <!-- ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶® ‡¶¨‡¶æ‡¶ü‡¶® -->
        <button onclick="showDownloadStats()" class="w-full bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 py-2 px-4 rounded-lg flex items-center justify-center gap-2 transition-all text-sm">
            <i class="fas fa-chart-bar"></i>
            <span>‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶®</span>
        </button>
    </div>
</div>


        </div>
    </div>
</section>


    <!-- Footer -->
    <footer class="bg-white dark:bg-slate-900 border-t border-gray-200 dark:border-slate-800 mt-12">
        <div class="container mx-auto px-4 py-8">
            <div class="text-center">
                <!-- Privacy Note -->
                <div class="bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4 mb-6 max-w-2xl mx-auto">
                    <div class="flex items-start gap-3">
                        <i class="fas fa-shield-alt text-green-600 dark:text-green-400 text-xl mt-1"></i>
                        <div class="text-left">
                            <h4 class="font-medium text-green-700 dark:text-green-300 mb-1">‡¶ó‡ßã‡¶™‡¶®‡ßÄ‡¶Ø‡¶º‡¶§‡¶æ ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§</h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400">
                                ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶õ‡¶¨‡¶ø ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏‡ßá ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡•§ ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶õ‡¶¨‡¶ø ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º ‡¶®‡¶æ‡•§
                            </p>
                        </div>
                    </div>
                </div>
                
                <div class="text-sm text-gray-500 dark:text-gray-400">
                        <div class="container mx-auto px-6">
        <div class="grid md:grid-cols-4 gap-8">
            <!-- Column 1: About -->
            <div>
                <div class="flex items-center gap-3 mb-6">
                    <div class="w-12 h-12 rounded-full overflow-hidden">
                        <img src="Logo_Big.gif" alt="Logo" class="w-full h-full object-cover">
                    </div>
                    <span class="text-xl font-light text-white font-shadhinata">‡¶Ü‡¶®‡ßã‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶õ‡¶ø‡¶¶‡ßç‡¶¶‡¶ø‡¶ï ‡¶ö‡ßå‡¶ß‡ßÅ‡¶∞‡ßÄ</span>
                </div>
                <p class="text-gray-400 text-sm mb-6">
                    ‡¶®‡ßá‡¶§‡ßÉ‡¶§‡ßç‡¶¨‡ßá ‡¶∏‡¶§‡¶§‡¶æ, ‡¶â‡¶®‡ßç‡¶®‡¶Ø‡¶º‡¶®‡ßá ‡¶è‡¶ï‡¶§‡¶æ<br>‡¶ö‡¶ü‡ßç‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ-‡ß™ ‡¶Ü‡¶∏‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∂‡ßç‡¶∞‡ßÅ‡¶§‡¶ø‡¶¨‡¶¶‡ßç‡¶ß
                </p>
            </div>

            <!-- Column 2: Quick Links -->
            <div>
                <h4 class="text-white text-lg font-medium mb-6 font-shadhinata">‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶≤‡¶ø‡¶Ç‡¶ï</h4>
                <ul class="space-y-3">
                    <li><a href="#about" class="text-gray-400 hover:text-white transition-colors text-sm">‡¶™‡¶∞‡¶ø‡¶ö‡¶ø‡¶§‡¶ø</a></li>
                    <li><a href="#manifesto" class="text-gray-400 hover:text-white transition-colors text-sm">‡¶á‡¶∂‡¶§‡ßá‡¶π‡¶æ‡¶∞</a></li>
                    <li><a href="#policy" class="text-gray-400 hover:text-white transition-colors text-sm">‡¶™‡¶≤‡¶ø‡¶∏‡¶ø ‡¶∏‡¶æ‡¶Æ‡¶ø‡¶ü ‡ß®‡ß¶‡ß®‡ß¨</a></li>
                    <li><a href="#gallery" class="text-gray-400 hover:text-white transition-colors text-sm">‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø</a></li>
                    <li><a href="#videos" class="text-gray-400 hover:text-white transition-colors text-sm">‡¶≠‡¶ø‡¶°‡¶ø‡¶ì</a></li>
                    <li><a href="#audios" class="text-gray-400 hover:text-white transition-colors text-sm">‡¶Ö‡¶°‡¶ø‡¶ì</a></li>
                    <li><a href="#contact" class="text-gray-400 hover:text-white transition-colors text-sm">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó</a></li>
                </ul>
            </div>

            <!-- Column 3: Social Media -->
            <div>
                <h4 class="text-white text-lg font-medium mb-6 font-shadhinata">‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶Æ‡¶ø‡¶°‡¶ø‡¶Ø‡¶º‡¶æ</h4>
                <div class="flex gap-4 mb-6">
                    <a href="https://facebook.com/anwarsiddikoffical" 
                       target="_blank" 
                       class="w-10 h-10 rounded-full bg-blue-600 hover:bg-blue-700 flex items-center justify-center text-white">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="#" 
                       target="_blank" 
                       class="w-10 h-10 rounded-full bg-blue-400 hover:bg-blue-500 flex items-center justify-center text-white">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="#" 
                       target="_blank" 
                       class="w-10 h-10 rounded-full bg-pink-600 hover:bg-pink-700 flex items-center justify-center text-white">
                        <i class="fab fa-instagram"></i>
                    </a>
                    <a href="#" 
                       target="_blank" 
                       class="w-10 h-10 rounded-full bg-red-600 hover:bg-red-700 flex items-center justify-center text-white">
                        <i class="fab fa-youtube"></i>
                    </a>
                </div>
            </div>

            <!-- Column 4: Contact Info -->
            <div>
                <h4 class="text-white text-lg font-medium mb-6 font-shadhinata">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó</h4>
                <ul class="space-y-3 text-sm text-gray-400">
                    <li class="flex items-center gap-2">
                        <i class="fas fa-map-marker-alt text-red-500"></i>
                        <span>‡¶∏‡ßÄ‡¶§‡¶æ‡¶ï‡ßÅ‡¶£‡ßç‡¶°, ‡¶ö‡¶ü‡ßç‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ</span>
                    </li>
                    <!-- <li class="flex items-center gap-2">
                        <i class="fas fa-envelope text-green-500"></i>
                        <span>info@anwarsiddik.com</span>
                    </li>
                    <li class="flex items-center gap-2">
                        <i class="fas fa-phone text-blue-500"></i>
                        <span>+‡ßÆ‡ßÆ‡ß¶ ‡ßß‡ß≠‡ß¶‡ß¶-‡ß¶‡ß¶‡ß¶‡ß¶‡ß¶</span>
                    </li> -->
                </ul>
            </div>
        </div>

        <!-- Copyright -->
        <div class="mt-12 pt-8 border-t border-gray-800 text-center">
            <p class="text-gray-500 text-sm">
                &copy; ‡ß®‡ß¶‡ß®‡ß¨ ‡¶Æ‡ßã‡¶É ‡¶Ü‡¶®‡ßã‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶õ‡¶ø‡¶¶‡ßç‡¶¶‡¶ø‡¶ï ‡¶ö‡ßå‡¶ß‡ßÅ‡¶∞‡ßÄ‡•§ ‡¶∏‡¶ï‡¶≤ ‡¶∏‡ßç‡¶¨‡¶§‡ßç‡¶¨ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§‡•§
                <br>
                <span class="text-gray-600 text-xs mt-2 block">
                    ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® ‡¶ì ‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶Æ‡ßá‡¶®‡ßç‡¶ü: ‡¶∞‡¶æ‡¶π‡¶æ‡¶§ ‡¶§‡¶æ‡¶π‡¶∏‡¶ø‡¶®
                </span>
            </p>
        </div>
    </div>

                    <br>
                    <a href="index.html" class="text-[#D3342D] hover:underline mt-2 inline-block">
                        <i class="fas fa-arrow-left mr-2"></i>‡¶Æ‡ßÇ‡¶≤ ‡¶™‡ßá‡¶á‡¶ú‡ßá ‡¶´‡¶ø‡¶∞‡ßÅ‡¶®
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Toast Container -->
    <div id="toast" class="toast"></div>

    <!-- Fabric.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script>

    <!-- Firebase for visitor counter -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<!-- Share Social Media JS -->
<script src="https://cdn.jsdelivr.net/npm/canvas2image@1.0.5/canvas2image.min.js"></script>

        <!-- Main Application Script -->
    <script>
        // ============================================
        // CONFIGURATION
        // ============================================
                // Configuration
        const CONFIG = {
            frames: [
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ßß", url: "frames/frame1.png" },
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ß®", url: "frames/frame2.png" },
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ß©", url: "frames/frame3.png" },
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ß™", url: "frames/frame4.png" },
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ß´", url: "frames/frame5.png" },
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ß¨", url: "frames/frame6.png" },
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ß≠", url: "frames/frame7.png" },
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ßÆ", url: "frames/frame8.png" },
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ßØ", url: "frames/frame9.png" },
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ßß‡ß¶", url: "frames/frame10.png" },
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ßß‡ßß", url: "frames/frame11.png" },
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ßß‡ß®", url: "frames/frame12.png" },
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ßß‡ß©", url: "frames/frame13.png" },
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ßß‡ß™", url: "frames/frame14.png" },
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ßß‡ß´", url: "frames/frame15.png" },
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ßß‡ß¨", url: "frames/frame16.png" },
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ßß‡ß≠", url: "frames/frame17.png" },
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ßß‡ßÆ", url: "frames/frame18.png" },
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ßß‡ßØ", url: "frames/frame19.png" },
                { name: "‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡ß®‡ß¶", url: "frames/frame20.png" }
                
            ],
            exportSize: 2048, // 2048x2048 pixels
            showWatermarkToggle: false,
            watermarkText: "#‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡¶Ø‡¶º‡¶≠‡ßã‡¶ü‡¶¶‡¶ø‡¶®",
            maxFileSize: 20 * 1024 * 1024, // 20MB
            maxImageDimension: 4096,
        };

        // ============================================
        // STATE
        // ============================================
        let fabricCanvas = null;
        let userImageObj = null;
        let frameImageObj = null;
        let currentImageSrc = null;
        let currentFrame = null;
        let frameImages = {};
        let noWatermark = true;
        
        // Touch state
        let lastTouchDistance = 0;
        let isPinching = false;

        // ============================================
        // DOM ELEMENTS
        // ============================================
        const fileInput = document.getElementById('fileInput');
        const framesGrid = document.getElementById('framesGrid');
        const previewCanvas = document.getElementById('previewCanvas');
        const previewContainer = document.getElementById('previewContainer');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const toast = document.getElementById('toast');

        const zoomSlider = document.getElementById('zoomSlider');
        const zoomValue = document.getElementById('zoomValue');
        const selectImageBtn = document.getElementById('selectImageBtn');
        const changeImageBtn = document.getElementById('changeImageBtn');
        const downloadBtn = document.getElementById('downloadBtn');

        // ============================================
        // INITIALIZATION
        // ============================================
        function init() {
            // Initialize Fabric.js canvas with responsive sizing
            const container = previewContainer;
            const containerWidth = container.offsetWidth;
            
            fabricCanvas = new fabric.Canvas('previewCanvas', {
                width: CONFIG.exportSize,
                height: CONFIG.exportSize,
                backgroundColor: 'transparent',
                selection: false,
                preserveObjectStacking: true,
                renderOnAddRemove: true,
                stateful: false
            });
            
            // Make canvas responsive - fit within container
            function resizeCanvas() {
                if (!fabricCanvas || !previewContainer) return;
                
                const containerWidth = previewContainer.offsetWidth;
                const containerHeight = previewContainer.offsetHeight;
                
                // Calculate scale to fit container (maintain aspect ratio)
                const scale = Math.min(containerWidth, containerHeight) / CONFIG.exportSize;
                
                // Set canvas display size (CSS only - keeps internal size at exportSize)
                const canvasElement = fabricCanvas.getElement();
                if (canvasElement) {
                    canvasElement.style.width = (CONFIG.exportSize * scale) + 'px';
                    canvasElement.style.height = (CONFIG.exportSize * scale) + 'px';
                    canvasElement.style.maxWidth = '100%';
                    canvasElement.style.maxHeight = '100%';
                }
                
                // Also update upper canvas if exists
                const upperCanvas = fabricCanvas.upperCanvasEl;
                if (upperCanvas) {
                    upperCanvas.style.width = (CONFIG.exportSize * scale) + 'px';
                    upperCanvas.style.height = (CONFIG.exportSize * scale) + 'px';
                    upperCanvas.style.maxWidth = '100%';
                    upperCanvas.style.maxHeight = '100%';
                }
                
                fabricCanvas.renderAll();
            }
            
            // Initial resize - wait for container to be ready
            setTimeout(() => {
                resizeCanvas();
            }, 100);
            
            // Resize on window resize
            let resizeTimeout;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(resizeCanvas, 100);
            });

            // Default object settings - will be customized per object
            // Don't disable controls globally - let each object set its own
            fabric.Object.prototype.lockRotation = true;

            loadFrames().then(() => {
                // Load default first frame after all frames are loaded
                if (currentFrame && frameImages[currentFrame]) {
                    updateFrame();
                }
            });

            selectImageBtn.addEventListener('click', () => fileInput.click());
            changeImageBtn.addEventListener('click', () => fileInput.click());
            fileInput.addEventListener('change', handleFileSelect);
            
            zoomSlider.addEventListener('input', handleZoom);
            downloadBtn.addEventListener('click', downloadImage);

            // Mouse wheel zoom (desktop)
            previewCanvas.addEventListener('wheel', handleWheel, { passive: false });

            // Touch events for pinch zoom (mobile)
            previewCanvas.addEventListener('touchstart', handleTouchStart, { passive: false });
            previewCanvas.addEventListener('touchmove', handleTouchMove, { passive: false });
            previewCanvas.addEventListener('touchend', handleTouchEnd);

            trackVisit();
        }

        // ============================================
        // ANALYTICS TRACKING
        // ============================================
        function trackVisit() {
            const analytics = getAnalytics();
            analytics.visits.push({
                timestamp: new Date().toISOString(),
                userAgent: navigator.userAgent,
                referrer: document.referrer || 'direct'
            });
            saveAnalytics(analytics);
        }

        function trackFrameGeneration(frameUrl) {
            const analytics = getAnalytics();
            analytics.generations.push({
                timestamp: new Date().toISOString(),
                frame: frameUrl,
                action: 'download'
            });
            saveAnalytics(analytics);
        }

        function trackFrameShare(frameUrl) {
            const analytics = getAnalytics();
            analytics.generations.push({
                timestamp: new Date().toISOString(),
                frame: frameUrl,
                action: 'share'
            });
            saveAnalytics(analytics);
        }

        function getAnalytics() {
            const data = localStorage.getItem('frameAnalytics');
            if (data) {
                return JSON.parse(data);
            }
            return {
                visits: [],
                generations: [],
                startDate: new Date().toISOString()
            };
        }

        function saveAnalytics(analytics) {
            localStorage.setItem('frameAnalytics', JSON.stringify(analytics));
        }

        // ============================================
        // FRAME MANAGEMENT
        // ============================================
        async function loadFrames() {
            const framePromises = [];
            
            for (const [index, frame] of CONFIG.frames.entries()) {
                const frameDiv = document.createElement('div');
                frameDiv.className = 'frame-option';
                if (index === 0) {
                    frameDiv.classList.add('selected');
                    currentFrame = frame.url;
                }
                frameDiv.dataset.frame = frame.url;

                const framePromise = (async () => {
                    try {
                        // Fetch frame and convert to data URL to avoid CORS issues
                        const response = await fetch(frame.url);
                        const blob = await response.blob();
                        const dataURL = await new Promise((resolve) => {
                            const reader = new FileReader();
                            reader.onloadend = () => resolve(reader.result);
                            reader.readAsDataURL(blob);
                        });
                        
                        // Store data URL for later use
                        frameImages[frame.url] = dataURL;
                        
                        const img = document.createElement('img');
                        img.src = dataURL;
                        img.alt = frame.name;
                        img.style.width = '100%';
                        img.style.height = '100%';
                        img.style.objectFit = 'cover';

                        const label = document.createElement('div');
                        label.className = 'absolute bottom-0 left-0 right-0 bg-black bg-opacity-70 text-white text-xs sm:text-sm text-center py-1 px-2 rounded-b-lg';
                        label.textContent = frame.name;

                        frameDiv.appendChild(img);
                        // frameDiv.appendChild(label);
                        frameDiv.addEventListener('click', () => selectFrame(frameDiv, frame.url));
                        
                        framesGrid.appendChild(frameDiv);
                        return true;
                    } catch (error) {
                        console.error('Failed to load frame:', frame.url, error);
                        frameDiv.style.background = `linear-gradient(135deg, #16a34a, #ea580c)`;
                        frameDiv.innerHTML = '<div class="flex items-center justify-center h-full text-white font-semibold">‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø</div>';
                        framesGrid.appendChild(frameDiv);
                        return false;
                    }
                })();
                
                framePromises.push(framePromise);
            }
            
            // Wait for all frames to load
            await Promise.all(framePromises);
            
            // Load default first frame after all frames are loaded and canvas is ready
            if (currentFrame && frameImages[currentFrame] && fabricCanvas) {
                setTimeout(() => {
                    if (fabricCanvas && frameImages[currentFrame] && !frameImageObj) {
                        updateFrame();
                    }
                }, 300);
            }
        }

        function selectFrame(element, frameUrl) {
            document.querySelectorAll('.frame-option').forEach(el => el.classList.remove('selected'));
            element.classList.add('selected');
            currentFrame = frameUrl;
            updateFrame();
        }

        function updateFrame() {
            if (!frameImages[currentFrame] || !fabricCanvas) {
                console.log('Cannot update frame:', { 
                    currentFrame, 
                    hasCanvas: !!fabricCanvas, 
                    hasFrameData: !!frameImages[currentFrame] 
                });
                return;
            }
            
            // Remove old frame if exists - ensure complete removal
            if (frameImageObj) {
                try {
                    // Remove from canvas
                    const objects = fabricCanvas.getObjects();
                    const frameIndex = objects.indexOf(frameImageObj);
                    if (frameIndex > -1) {
                        fabricCanvas.remove(frameImageObj);
                    }
                    // Dispose the object
                    frameImageObj.dispose();
                } catch (e) {
                    console.error('Error removing old frame:', e);
                }
                frameImageObj = null;
                fabricCanvas.renderAll(); // Render after removal
            }
            
            // Add frame on top - exactly 100% width and height
            try {
                fabric.Image.fromURL(frameImages[currentFrame], (img) => {
                    if (!img) {
                        console.error('Failed to load frame image');
                        showToast('‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§', 'error');
                        return;
                    }
                    
                    // Scale frame to exactly match canvas size (100% width and height)
                    const scaleX = CONFIG.exportSize / img.width;
                    const scaleY = CONFIG.exportSize / img.height;
                    // Use max to ensure frame covers entire canvas (100% coverage)
                    const scale = Math.max(scaleX, scaleY);
                    
                    img.set({
                        left: CONFIG.exportSize / 2,
                        top: CONFIG.exportSize / 2,
                        originX: 'center',
                        originY: 'center',
                        scaleX: scale,
                        scaleY: scale,
                        selectable: false,
                        evented: false, // Frame should not block user image interactions
                        excludeFromExport: false,
                        lockMovementX: true,
                        lockMovementY: true,
                        lockScalingX: true,
                        lockScalingY: true,
                        hoverCursor: 'default',
                        moveCursor: 'default',
                        // Ensure frame doesn't interfere with controls
                        perPixelTargetFind: false,
                        objectCaching: false
                    });
                    
                    frameImageObj = img;
                    fabricCanvas.add(img);
                    // Ensure frame is on top and user image is below
                    if (userImageObj) {
                        fabricCanvas.sendToBack(userImageObj);
                    } else {
                        // If no user image, bring frame to front
                        fabricCanvas.bringToFront(img);
                    }
                    fabricCanvas.renderAll();
                }, {
                    crossOrigin: 'anonymous'
                });
            } catch (error) {
                console.error('Error loading frame:', error);
                showToast('‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§', 'error');
            }
        }

        // ============================================
        // FILE HANDLING
        // ============================================
        function handleFileSelect(e) {
            const file = e.target.files[0];
            if (!file) return;

            // Validate file
            if (!file.type.match('image.*')) {
                showToast('‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶õ‡¶¨‡¶ø ‡¶´‡¶æ‡¶á‡¶≤ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'error');
                return;
            }

            if (file.size > CONFIG.maxFileSize) {
                showToast('‡¶´‡¶æ‡¶á‡¶≤ ‡¶ñ‡ßÅ‡¶¨ ‡¶¨‡¶°‡¶º‡•§ ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡ßß‡ß¶ MB ‡¶Ö‡¶®‡ßÅ‡¶Æ‡ßã‡¶¶‡¶ø‡¶§‡•§', 'error');
                return;
            }

            // Read and load image
            const reader = new FileReader();
            reader.onload = (event) => {
                loadImage(event.target.result);
            };
            reader.readAsDataURL(file);
        }

        function loadImage(imageSrc) {
            currentImageSrc = imageSrc;
            
            fabric.Image.fromURL(imageSrc, (img) => {
                // Check if image needs downscaling
                const maxDim = Math.max(img.width, img.height);
                if (maxDim > CONFIG.maxImageDimension) {
                    const scale = CONFIG.maxImageDimension / maxDim;
                    img.scale(scale);
                }

                // Center the image at canvas center
                const canvasSize = CONFIG.exportSize;
                const centerX = canvasSize / 2;
                const centerY = canvasSize / 2;
                
                // Using default Fabric.js resize controls - no custom handlers needed

                img.set({
                    left: centerX,
                    top: centerY,
                    originX: 'center',
                    originY: 'center',
                    selectable: true,
                    evented: true,
                    // Enable default Fabric.js resize controls (4 corners)
                    hasControls: true,
                    hasBorders: true,
                    borderColor: '#16a34a',
                    borderOpacityWhenMoving: 1,
                    borderDashArray: [5, 5],
                    cornerColor: '#16a34a',
                    cornerSize: 18,
                    cornerStyle: 'circle',
                    transparentCorners: false,
                    borderScaleFactor: 2,
                    cornerStrokeColor: '#ffffff',
                    cornerStrokeWidth: 3,
                    // Allow movement and scaling
                    lockMovementX: false,
                    lockMovementY: false,
                    lockRotation: true,
                    lockScalingX: false,
                    lockScalingY: false,
                    lockUniScaling: true, // Maintain aspect ratio when resizing from corners (default 4 corner controls)
                    // Make controls more visible
                    padding: 8
                    // Using default Fabric.js corner controls (4 corners) - no custom edge controls
                    // lockUniScaling ensures aspect ratio is maintained when resizing
                });

                // Remove old image if exists
                if (userImageObj) {
                    fabricCanvas.remove(userImageObj);
                }

                userImageObj = img;
                fabricCanvas.add(img);
                // Ensure user image is below frame
                if (frameImageObj) {
                    fabricCanvas.sendToBack(img);
                    // Make sure frame doesn't block clicks - bring frame to front but keep it non-interactive
                    fabricCanvas.bringToFront(frameImageObj);
                }
                
                // Set as active object to show controls immediately
                fabricCanvas.setActiveObject(img);
                
                // Force show controls - multiple attempts to ensure visibility
                setTimeout(() => {
                    if (fabricCanvas && userImageObj === img) {
                        fabricCanvas.setActiveObject(img);
                        fabricCanvas.renderAll();
                    }
                }, 100);
                
                setTimeout(() => {
                    if (fabricCanvas && userImageObj === img) {
                        fabricCanvas.setActiveObject(img);
                        fabricCanvas.renderAll();
                    }
                }, 300);
                
                // Add event listeners for resize and movement
                img.on('modified', () => {
                    fabricCanvas.renderAll();
                });
                
                img.on('scaling', () => {
                    fabricCanvas.renderAll();
                });
                
                img.on('moving', () => {
                    fabricCanvas.renderAll();
                });
                
                img.on('selected', () => {
                    fabricCanvas.renderAll();
                });
                
                // Ensure image can be selected even when frame is on top
                img.on('mousedown', (e) => {
                    fabricCanvas.setActiveObject(img);
                    fabricCanvas.renderAll();
                    if (e.e) e.e.stopPropagation();
                });
                
                // Click on canvas to select image
                fabricCanvas.on('mouse:down', (e) => {
                    if (e.target === img || (!e.target && userImageObj === img)) {
                        fabricCanvas.setActiveObject(img);
                        fabricCanvas.renderAll();
                    }
                });
                
                fabricCanvas.renderAll();

                // Reset zoom slider to 0% (1x scale)
                zoomSlider.value = 0;
                zoomValue.textContent = '0%';

                // Show change image button
                selectImageBtn.classList.add('hidden');
                changeImageBtn.classList.remove('hidden');
                previewContainer.classList.add('has-image');

                // Update frame (ensure frame is on top)
                if (frameImageObj) {
                    fabricCanvas.bringToFront(frameImageObj);
                }
                fabricCanvas.renderAll();
            }, {
                crossOrigin: 'anonymous'
            });
        }

        // ============================================
        // CANVAS INTERACTION (Mouse Wheel Zoom)
        // ============================================
        function handleWheel(e) {
            if (!userImageObj) return;
            e.preventDefault();
            
            const delta = e.deltaY > 0 ? -0.05 : 0.05;
            const currentScale = userImageObj.scaleX;
            const newScale = Math.max(0, Math.min(3, currentScale + delta));
            
            // Zoom centered on canvas
            const canvasCenter = {
                x: CONFIG.exportSize / 2,
                y: CONFIG.exportSize / 2
            };
            
            const scaleRatio = newScale / currentScale;
            const imgCenterX = userImageObj.left;
            const imgCenterY = userImageObj.top;
            
            userImageObj.scale(newScale);
            userImageObj.set({
                left: canvasCenter.x - (canvasCenter.x - imgCenterX) * scaleRatio,
                top: canvasCenter.y - (canvasCenter.y - imgCenterY) * scaleRatio
            });
            
            // Update slider: scale 0-3 maps to -100% to 200%
            const zoomPercent = Math.round((newScale * 100) - 100);
            zoomSlider.value = Math.max(-100, Math.min(200, zoomPercent));
            zoomValue.textContent = zoomSlider.value + '%';
            
            fabricCanvas.renderAll();
        }

        // ============================================
        // CANVAS INTERACTION (Touch - Pinch Zoom)
        // ============================================
        function handleTouchStart(e) {
            if (!userImageObj) return;
            
            if (e.touches.length === 2) {
                e.preventDefault();
                isPinching = true;
                const touch1 = e.touches[0];
                const touch2 = e.touches[1];
                lastTouchDistance = Math.hypot(
                    touch2.clientX - touch1.clientX,
                    touch2.clientY - touch1.clientY
                );
            }
        }

        function handleTouchMove(e) {
            if (!userImageObj || !isPinching) return;
            
            if (e.touches.length === 2) {
                e.preventDefault();
                const touch1 = e.touches[0];
                const touch2 = e.touches[1];
                const distance = Math.hypot(
                    touch2.clientX - touch1.clientX,
                    touch2.clientY - touch1.clientY
                );
                
                if (lastTouchDistance > 0) {
                    const scaleChange = distance / lastTouchDistance;
                    const currentScale = userImageObj.scaleX;
                    const newScale = Math.max(0, Math.min(3, currentScale * scaleChange));
                    
                    // Zoom centered on canvas (not on touch point for consistency)
                    const canvasCenter = {
                        x: CONFIG.exportSize / 2,
                        y: CONFIG.exportSize / 2
                    };
                    
                    const scaleRatio = newScale / currentScale;
                    const imgCenterX = userImageObj.left;
                    const imgCenterY = userImageObj.top;
                    
                    userImageObj.scale(newScale);
                    userImageObj.set({
                        left: canvasCenter.x - (canvasCenter.x - imgCenterX) * scaleRatio,
                        top: canvasCenter.y - (canvasCenter.y - imgCenterY) * scaleRatio
                    });
                    
                    // Update slider: scale 0-3 maps to -100% to 200%
                    const zoomPercent = Math.round((newScale * 100) - 100);
                    zoomSlider.value = Math.max(-100, Math.min(200, zoomPercent));
                    zoomValue.textContent = zoomSlider.value + '%';
                    
                    fabricCanvas.renderAll();
                }
                lastTouchDistance = distance;
            }
        }

        function handleTouchEnd(e) {
            isPinching = false;
            lastTouchDistance = 0;
        }

        // ============================================
        // ZOOM SLIDER
        // ============================================
        function handleZoom(e) {
            if (!userImageObj) return;
            const sliderValue = parseInt(e.target.value);
            zoomValue.textContent = sliderValue + '%';
            
            // Calculate scale: -100% = 0x, 0% = 1x, 100% = 2x, 200% = 3x
            const newScale = (sliderValue + 100) / 100; // Range: 0 to 3
            const currentScale = userImageObj.scaleX;
            
            // Zoom centered on canvas
            const canvasCenter = {
                x: CONFIG.exportSize / 2,
                y: CONFIG.exportSize / 2
            };
            
            // Calculate scale ratio
            const scaleRatio = newScale / currentScale;
            
            // Get current image center
            const imgCenterX = userImageObj.left;
            const imgCenterY = userImageObj.top;
            
            // Apply new scale
            userImageObj.scale(newScale);
            
            // Keep image centered on canvas while zooming
            userImageObj.set({
                left: canvasCenter.x - (canvasCenter.x - imgCenterX) * scaleRatio,
                top: canvasCenter.y - (canvasCenter.y - imgCenterY) * scaleRatio
            });
            
            fabricCanvas.renderAll();
        }

        // Fabric.js handles rendering automatically - no need for manual preview functions

        function drawWatermark(ctx, size) {
            ctx.save();
            ctx.font = `${size * 0.025}px 'Hind Siliguri', sans-serif`;
            ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';
            ctx.textAlign = 'right';
            ctx.textBaseline = 'bottom';
            ctx.fillText(CONFIG.watermarkText, size - 20, size - 20);
            ctx.restore();
        }

        // ============================================
        // EXPORT
        // ============================================
        async function downloadImage() {
            if (!userImageObj) {
                showToast('‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶ó‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶õ‡¶¨‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'error');
                return;
            }

            showLoading(true);

            try {
                await new Promise(resolve => setTimeout(resolve, 100));
                
                // Export canvas to data URL using Fabric.js
                const dataURL = fabricCanvas.toDataURL({
                    format: 'png',
                    quality: 1.0,
                    multiplier: 1,
                    enableRetinaScaling: true
                });
                
                const filename = `daripalla_frame_${Date.now()}.png`;
                
                // Create download link
                const a = document.createElement('a');
                a.href = dataURL;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);

                // Track download
                trackFrameGeneration(currentFrame);

                showToast('‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!', 'success');
            } catch (error) {
                console.error('Export error:', error);
                showToast('‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'error');
            } finally {
                showLoading(false);
            }
        }

        async function shareImage() {
            if (!cropper) {
                showToast('‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶ó‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶õ‡¶¨‡¶ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'error');
                return;
            }

            showLoading(true);

            try {
                const size = CONFIG.exportSize;
                
                // Create final export canvas
                const finalCanvas = document.createElement('canvas');
                finalCanvas.width = size;
                finalCanvas.height = size;
                const ctx = finalCanvas.getContext('2d');

                // Clear canvas (transparent background)
                ctx.clearRect(0, 0, size, size);

                // Get and draw cropped image
                const croppedCanvas = cropper.getCroppedCanvas({
                    width: size,
                    height: size,
                });

                if (croppedCanvas) {
                    ctx.drawImage(croppedCanvas, 0, 0, size, size);
                }

                // Draw frame if available - use stored data URL
                if (currentFrame && frameImages[currentFrame]) {
                    const frameImg = new Image();
                    await new Promise((resolve, reject) => {
                        frameImg.onload = resolve;
                        frameImg.onerror = reject;
                        frameImg.src = frameImages[currentFrame];
                    });
                    ctx.drawImage(frameImg, 0, 0, size, size);
                }

                // Convert to blob for sharing
                const blob = await new Promise(resolve => {
                    finalCanvas.toBlob(resolve, 'image/png', 1.0);
                });

                const filename = `daripalla_frame_${Date.now()}.png`;
                const file = new File([blob], filename, { type: 'image/png' });

                // Check if Web Share API is available
                if (navigator.share && navigator.canShare && navigator.canShare({ files: [file] })) {
                    await navigator.share({
                        files: [file],
                        title: '‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡¶Ø‡¶º ‡¶≠‡ßã‡¶ü ‡¶¶‡¶ø‡¶®',
                        text: '‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®! https://frame.daripalla.org/frame2'
                    });
                    
                    // Track share
                    trackFrameShare(currentFrame);
                    
                    showToast('‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!', 'success');
                } else {
                    // Fallback to download if sharing not supported
                    const dataURL = finalCanvas.toDataURL('image/png', 1.0);
                    const a = document.createElement('a');
                    a.href = dataURL;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    showToast('‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶∞‡ßç‡¶•‡¶ø‡¶§ ‡¶®‡¶Ø‡¶º‡•§ ‡¶õ‡¶¨‡¶ø ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§', 'success');
                }
            } catch (error) {
                if (error.name !== 'AbortError') {
                    console.error('Share error:', error);
                    showToast('‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§', 'error');
                }
            } finally {
                showLoading(false);
            }
        }

        // ============================================
        // UI HELPERS
        // ============================================
        function showLoading(show) {
            if (show) {
                loadingIndicator.classList.remove('hidden');
            } else {
                loadingIndicator.classList.add('hidden');
            }
        }

        function showToast(message, type = 'info') {
            toast.textContent = message;
            toast.className = 'toast show';
            if (type === 'error') toast.classList.add('error');
            if (type === 'success') toast.classList.add('success');

            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // ============================================
        // START APPLICATION
        // ============================================
        function startApp() {
            if (typeof fabric === 'undefined') {
                // Wait for Fabric.js to load (max 10 seconds)
                const startTime = Date.now();
                const checkFabric = setInterval(() => {
                    if (typeof fabric !== 'undefined') {
                        clearInterval(checkFabric);
                        init();
                    } else if (Date.now() - startTime > 10000) {
                        clearInterval(checkFabric);
                        showToast('Fabric.js ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶™‡ßá‡¶ú ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'error');
                        console.error('Fabric.js failed to load');
                    }
                }, 100);
                return;
            }
            init();
        }

        window.addEventListener('DOMContentLoaded', startApp);
    </script>


    <script>
        // Mobile-specific functions
function resetImage() {
    if (!userImageObj) return;
    
    const centerX = CONFIG.exportSize / 2;
    const centerY = CONFIG.exportSize / 2;
    const maxSize = CONFIG.exportSize * 0.8;
    const scale = Math.min(maxSize / userImageObj.width, maxSize / userImageObj.height);
    
    userImageObj.set({
        left: centerX,
        top: centerY,
        scaleX: scale,
        scaleY: scale
    });
    
    zoomSlider.value = 100;
    zoomValue.textContent = '100%';
    fabricCanvas.renderAll();
    showToast('‡¶õ‡¶¨‡¶ø ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá', 'success');
}

function centerImage() {
    if (!userImageObj) return;
    
    userImageObj.set({
        left: CONFIG.exportSize / 2,
        top: CONFIG.exportSize / 2
    });
    
    fabricCanvas.renderAll();
    showToast('‡¶õ‡¶¨‡¶ø ‡¶∏‡ßá‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡ßá ‡¶Ü‡¶®‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá', 'success');
}

function shareOnWhatsApp() {
    if (!userImageObj) {
        showToast('‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶õ‡¶¨‡¶ø ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®', 'error');
        return;
    }
    
    const shareText = '‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡¶Ø‡¶º ‡¶≠‡ßã‡¶ü ‡¶¶‡¶ø‡¶® - ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßÄ ‡¶∂‡¶æ‡¶∏‡¶®‡¶§‡¶®‡ßç‡¶§‡ßç‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø';
    const shareURL = 'https://anwarsiddique.info.bd/frame-generator';
    window.open(`https://wa.me/?text=${encodeURIComponent(shareText + ' ' + shareURL)}`, '_blank');
}

function shareOnMessenger() {
    const shareURL = 'https://anwarsiddique.info.bd/frame-generator';
    window.open(`https://www.facebook.com/dialog/send?link=${encodeURIComponent(shareURL)}&app_id=YOUR_APP_ID`, '_blank');
}
    </script>

    <style>
/* Enhanced Mobile Responsiveness - Fix Canvas Size */
@media (max-width: 640px) {
    /* Canvas container - reduce size for mobile */
    #previewContainer {
        width: 90vw !important;
        height: 90vw !important;
        max-width: 350px !important;
        max-height: 350px !important;
        margin: 0 auto 1.5rem auto !important;
    }
    
    /* Adjust canvas itself */
    .canvas-container {
        width: 100% !important;
        height: 100% !important;
    }
    
    /* Reduce surrounding padding */
    main {
        padding-top: 4rem !important;
        padding-bottom: 2rem !important;
    }
    
    /* Header size adjustment */
    .text-center h1 {
        font-size: 1.5rem !important;
        margin-bottom: 0.75rem !important;
    }
    
    .text-center p {
        font-size: 0.875rem !important;
        margin-bottom: 1.5rem !important;
    }
    
    /* Frame options grid - smaller for mobile */
    .frame-option {
        width: 65px !important;
        height: 65px !important;
        min-width: 65px !important;
    }
    
    /* Reduce padding in cards */
    .bg-white.dark\\:bg-slate-800.rounded-xl {
        padding: 1rem !important;
    }
    
    /* Button adjustments */
    button, .frame-option, input[type="range"] {
        min-height: 40px !important;
    }
    
    /* Reduce gap between columns */
    .grid.grid-cols-1.lg\\:grid-cols-3 {
        gap: 0.75rem !important;
    }
    
    /* Feature section padding */
    section.py-8.md\\:py-12 {
        padding-top: 2rem !important;
        padding-bottom: 2rem !important;
    }
    
    /* Hide mobile touch hints when not needed */
    #previewContainer .lg\\:hidden.absolute.bottom-3 {
        display: none;
    }
}

/* Tablet adjustments */
@media (min-width: 641px) and (max-width: 1024px) {
    #previewContainer {
        width: 70vw !important;
        height: 70vw !important;
        max-width: 450px !important;
        max-height: 450px !important;
        margin: 0 auto 2rem auto !important;
    }
    
    .frame-option {
        width: 80px !important;
        height: 80px !important;
        min-width: 80px !important;
    }
}

/* Improve canvas rendering on mobile */
@media (max-width: 1024px) {
    canvas {
        touch-action: manipulation;
    }
    
    /* Prevent text selection on touch */
    .no-select {
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
    }
    
    /* Smooth scrolling for frame options */
    #framesGrid {
        -webkit-overflow-scrolling: touch;
        scroll-behavior: smooth;
    }
}

/* Fix for very small screens */
@media (max-width: 360px) {
    #previewContainer {
        width: 85vw !important;
        height: 85vw !important;
        max-width: 300px !important;
        max-height: 300px !important;
    }
    
    .frame-option {
        width: 60px !important;
        height: 60px !important;
        min-width: 60px !important;
    }
    
    .text-center h1 {
        font-size: 1.25rem !important;
    }
}
</style>

<style>
/* Enhanced Mobile Responsiveness - Fix Canvas Size */
@media (max-width: 640px) {
    /* Canvas container - reduce size for mobile */
    #previewContainer {
        width: 90vw !important;
        height: 90vw !important;
        max-width: 350px !important;
        max-height: 350px !important;
        margin: 0 auto 1.5rem auto !important;
    }
    
    /* Adjust canvas itself */
    .canvas-container {
        width: 100% !important;
        height: 100% !important;
    }
    
    /* Reduce surrounding padding */
    main {
        padding-top: 4rem !important;
        padding-bottom: 2rem !important;
    }
    
    /* Header size adjustment */
    .text-center h1 {
        font-size: 1.5rem !important;
        margin-bottom: 0.75rem !important;
    }
    
    .text-center p {
        font-size: 0.875rem !important;
        margin-bottom: 1.5rem !important;
    }
    
    /* Frame options grid - smaller for mobile */
    .frame-option {
        width: 65px !important;
        height: 65px !important;
        min-width: 65px !important;
    }
    
    /* Reduce padding in cards */
    .bg-white.dark\\:bg-slate-800.rounded-xl {
        padding: 1rem !important;
    }
    
    /* Button adjustments */
    button, .frame-option, input[type="range"] {
        min-height: 40px !important;
    }
    
    /* Reduce gap between columns */
    .grid.grid-cols-1.lg\\:grid-cols-3 {
        gap: 0.75rem !important;
    }
    
    /* Feature section padding */
    section.py-8.md\\:py-12 {
        padding-top: 2rem !important;
        padding-bottom: 2rem !important;
    }
    
    /* Hide mobile touch hints when not needed */
    #previewContainer .lg\\:hidden.absolute.bottom-3 {
        display: none;
    }
}

/* Tablet adjustments */
@media (min-width: 641px) and (max-width: 1024px) {
    #previewContainer {
        width: 70vw !important;
        height: 70vw !important;
        max-width: 450px !important;
        max-height: 450px !important;
        margin: 0 auto 2rem auto !important;
    }
    
    .frame-option {
        width: 80px !important;
        height: 80px !important;
        min-width: 80px !important;
    }
}

/* Improve canvas rendering on mobile */
@media (max-width: 1024px) {
    canvas {
        touch-action: manipulation;
    }
    
    /* Prevent text selection on touch */
    .no-select {
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
    }
    
    /* Smooth scrolling for frame options */
    #framesGrid {
        -webkit-overflow-scrolling: touch;
        scroll-behavior: smooth;
    }
}

/* Fix for very small screens */
@media (max-width: 360px) {
    #previewContainer {
        width: 85vw !important;
        height: 85vw !important;
        max-width: 300px !important;
        max-height: 300px !important;
    }
    
    .frame-option {
        width: 60px !important;
        height: 60px !important;
        min-width: 60px !important;
    }
    
    .text-center h1 {
        font-size: 1.25rem !important;
    }
}

/* Mobile Canvas Size Fix */
@media (max-width: 640px) {
    .canvas-container {
        width: 90vw !important;
        height: 90vw !important;
        max-width: 350px !important;
        max-height: 350px !important;
        margin: 0 auto !important;
    }
    
    #previewCanvas {
        width: 100% !important;
        height: 100% !important;
    }
}
</style>
<script>
// Enhanced download function with better error handling
function downloadImage() {
    if (!userImageObj) {
        showToast('‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶ó‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶õ‡¶¨‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'error');
        return;
    }

    showLoading(true);

    try {
        // Create a temporary canvas for download
        const tempCanvas = document.createElement('canvas');
        tempCanvas.width = CONFIG.exportSize;
        tempCanvas.height = CONFIG.exportSize;
        const ctx = tempCanvas.getContext('2d');
        
        // Draw white background
        ctx.fillStyle = '#ffffff';
        ctx.fillRect(0, 0, CONFIG.exportSize, CONFIG.exportSize);
        
        // Draw frame if exists
        if (frameImageObj) {
            const frameImg = new Image();
            frameImg.crossOrigin = 'anonymous';
            frameImg.onload = () => {
                ctx.drawImage(frameImg, 0, 0, CONFIG.exportSize, CONFIG.exportSize);
                
                // Draw user image
                fabricCanvas.getContext().drawImage(userImageObj._element, 0, 0);
                
                // Trigger download
                setTimeout(() => {
                    const link = document.createElement('a');
                    link.download = `‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ_‡¶´‡ßç‡¶∞‡ßá‡¶Æ_${Date.now()}.png`;
                    link.href = tempCanvas.toDataURL('image/png');
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    showToast('‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!', 'success');
                    showLoading(false);
                }, 500);
            };
            frameImg.src = frameImages[currentFrame];
        } else {
            // If no frame, just download the image
            const link = document.createElement('a');
            link.download = `‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ_‡¶´‡ßç‡¶∞‡ßá‡¶Æ_${Date.now()}.png`;
            link.href = fabricCanvas.toDataURL('image/png');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showToast('‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!', 'success');
            showLoading(false);
        }
        
    } catch (error) {
        console.error('Download error:', error);
        showToast('‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'error');
        showLoading(false);
        
        // Fallback method
        try {
            const dataURL = fabricCanvas.toDataURL('image/png');
            const link = document.createElement('a');
            link.download = `‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ_‡¶´‡ßç‡¶∞‡ßá‡¶Æ_${Date.now()}.png`;
            link.href = dataURL;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            showToast('‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® (‡¶¨‡¶ø‡¶ï‡¶≤‡ßç‡¶™ ‡¶™‡¶¶‡ßç‡¶ß‡¶§‡¶ø)', 'success');
        } catch (fallbackError) {
            showToast('‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'error');
        }
    }
}

// Replace the existing download function
document.getElementById('downloadBtn').addEventListener('click', downloadImage);

// Alternative simple download function (for testing)
function simpleDownload() {
    if (!userImageObj) {
        showToast('‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶ó‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶õ‡¶¨‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'error');
        return;
    }
    
    const link = document.createElement('a');
    link.download = `daripalla_frame_${Date.now()}.png`;
    link.href = fabricCanvas.toDataURL();
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    showToast('‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!', 'success');
}

// Add a test button for debugging (optional)
const testBtn = document.createElement('button');
testBtn.textContent = '‡¶ü‡ßá‡¶∏‡ßç‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°';
testBtn.className = 'bg-red-500 text-white p-2 rounded mt-4';
testBtn.onclick = simpleDownload;
// document.body.appendChild(testBtn); // Uncomment for debugging
</script>
<style>
/* ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
#downloadCounter, #todayDownloads {
    text-shadow: 0 2px 4px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
}

/* ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶® ‡¶™‡¶™‡¶Ü‡¶™ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
.fixed.bottom-20 {
    animation: slideUp 0.3s ease;
}

@keyframes slideUp {
    from {
        transform: translateY(20px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}
</style>
<script>
// ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ
const downloadCounter = {
    // ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶∞‡¶æ‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø localStorage key
    storageKey: 'daripalla_download_count',
    storageKeyByDate: 'daripalla_downloads_by_date',
    storageKeyDaily: 'daripalla_downloads_daily',
    
    // ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú
    init() {
        // ‡¶ü‡ßã‡¶ü‡¶æ‡¶≤ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú
        if (!localStorage.getItem(this.storageKey)) {
            localStorage.setItem(this.storageKey, '0');
        }
        
        // ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶°‡ßá‡¶ü‡¶æ ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú
        if (!localStorage.getItem(this.storageKeyByDate)) {
            localStorage.setItem(this.storageKeyByDate, JSON.stringify({}));
        }
        
        // ‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú
        this.initDailyCounter();
        
        // UI ‡¶§‡ßá ‡¶∂‡ßã ‡¶ï‡¶∞‡¶æ‡¶®‡ßã
        this.updateCounterDisplay();
    },
    
    // ‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú
    initDailyCounter() {
        const today = this.getTodayDate();
        const dailyData = JSON.parse(localStorage.getItem(this.storageKeyDaily) || '{}');
        
        if (!dailyData.date || dailyData.date !== today) {
            // ‡¶®‡¶§‡ßÅ‡¶® ‡¶¶‡¶ø‡¶® ‡¶∂‡ßÅ‡¶∞‡ßÅ - ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü
            localStorage.setItem(this.storageKeyDaily, JSON.stringify({
                date: today,
                count: 0
            }));
        }
    },
    
    // ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶™‡ßá‡¶§‡ßá
    getTodayDate() {
        const now = new Date();
        return now.toISOString().split('T')[0]; // YYYY-MM-DD ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü
    },
    
    // ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶á‡¶®‡¶ï‡ßç‡¶∞‡¶ø‡¶Æ‡ßá‡¶®‡ßç‡¶ü
    incrementDownload() {
        try {
            // ‡¶ü‡ßã‡¶ü‡¶æ‡¶≤ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶¨‡¶æ‡¶°‡¶º‡¶æ‡¶®‡ßã
            const totalCount = parseInt(localStorage.getItem(this.storageKey)) || 0;
            const newTotalCount = totalCount + 1;
            localStorage.setItem(this.storageKey, newTotalCount.toString());
            
            // ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶¨‡¶æ‡¶°‡¶º‡¶æ‡¶®‡ßã
            const dateKey = this.getTodayDate();
            const downloadsByDate = JSON.parse(localStorage.getItem(this.storageKeyByDate) || '{}');
            downloadsByDate[dateKey] = (downloadsByDate[dateKey] || 0) + 1;
            localStorage.setItem(this.storageKeyByDate, JSON.stringify(downloadsByDate));
            
            // ‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶¨‡¶æ‡¶°‡¶º‡¶æ‡¶®‡ßã
            const dailyData = JSON.parse(localStorage.getItem(this.storageKeyDaily) || '{}');
            dailyData.count = (dailyData.count || 0) + 1;
            dailyData.date = dateKey;
            localStorage.setItem(this.storageKeyDaily, JSON.stringify(dailyData));
            
            // UI ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
            this.updateCounterDisplay();
            
            return newTotalCount;
        } catch (error) {
            console.error('Error incrementing download count:', error);
            return 0;
        }
    },
    
    // ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶ø‡¶∏‡ßç‡¶ü‡¶ø‡¶ï‡ßç‡¶∏ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ
    getDownloadStats() {
        const total = parseInt(localStorage.getItem(this.storageKey)) || 0;
        const dailyData = JSON.parse(localStorage.getItem(this.storageKeyDaily) || '{}');
        const downloadsByDate = JSON.parse(localStorage.getItem(this.storageKeyByDate) || '{}');
        
        // ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ
        let maxDate = '';
        let maxCount = 0;
        for (const [date, count] of Object.entries(downloadsByDate)) {
            if (count > maxCount) {
                maxCount = count;
                maxDate = date;
            }
        }
        
        return {
            total: total,
            today: dailyData.count || 0,
            maxDate: maxDate,
            maxCount: maxCount,
            allDates: downloadsByDate
        };
    },
    
    // ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶°‡¶ø‡¶∏‡¶™‡ßç‡¶≤‡ßá ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
    updateCounterDisplay() {
        const stats = this.getDownloadStats();
        
        // ‡¶ü‡ßã‡¶ü‡¶æ‡¶≤ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞
        const totalElement = document.getElementById('downloadCounter');
        if (totalElement) {
            totalElement.textContent = stats.total.toLocaleString('bn-BD');
        }
        
        // ‡¶ü‡ßÅ‡¶°‡ßá'‡¶∏ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞
        const todayElement = document.getElementById('todayDownloads');
        if (todayElement) {
            todayElement.textContent = stats.today.toLocaleString('bn-BD');
        }
        
        // ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ
        const maxElement = document.getElementById('maxDownloadDate');
        if (maxElement && stats.maxDate) {
            const date = new Date(stats.maxDate);
            const formattedDate = date.toLocaleDateString('bn-BD', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            maxElement.textContent = `${formattedDate} (${stats.maxCount}‡¶ü‡¶ø)`;
        }
    },
    
    // ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü (‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶Æ‡ßá‡¶®‡ßç‡¶ü‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø)
    resetCounter() {
        if (confirm('‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶Ø‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ‡¶∏‡¶ï‡¶≤ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?')) {
            localStorage.setItem(this.storageKey, '0');
            localStorage.setItem(this.storageKeyByDate, JSON.stringify({}));
            localStorage.setItem(this.storageKeyDaily, JSON.stringify({
                date: this.getTodayDate(),
                count: 0
            }));
            this.updateCounterDisplay();
            alert('‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');
        }
    }
};

// ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®‡ßá ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®
async function downloadImage() {
    if (!userImageObj) {
        showToast('‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶ó‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶õ‡¶¨‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'error');
        return;
    }

    showLoading(true);

    try {
        await new Promise(resolve => setTimeout(resolve, 100));
        
        // ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶á‡¶®‡¶ï‡ßç‡¶∞‡¶ø‡¶Æ‡ßá‡¶®‡ßç‡¶ü
        const downloadCount = downloadCounter.incrementDownload();
        
        const dataURL = fabricCanvas.toDataURL({
            format: 'png',
            quality: 1.0,
            multiplier: 1,
            enableRetinaScaling: true
        });
        
        const filename = `‡¶¶‡¶æ‡¶Å‡¶°‡¶º‡¶ø‡¶™‡¶æ‡¶≤‡ßç‡¶≤‡¶æ_‡¶´‡ßç‡¶∞‡ßá‡¶Æ_${downloadCount}.png`;
        
        const a = document.createElement('a');
        a.href = dataURL;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);

        // Track download
        trackFrameGeneration(currentFrame);

        showToast(`‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®! ‡¶Æ‡ßã‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°: ${downloadCount}`, 'success');
    } catch (error) {
        console.error('Export error:', error);
        showToast('‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', 'error');
    } finally {
        showLoading(false);
    }
}

// ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡¶æ‡¶•‡ßá ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶æ‡¶∞ ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú ‡¶ï‡¶∞‡ßÅ‡¶®
window.addEventListener('DOMContentLoaded', () => {
    downloadCounter.init();
});

// ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø (‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶°‡ßá‡¶≠‡ßá‡¶≤‡¶™‡¶Æ‡ßá‡¶®‡ßç‡¶ü)
function showDownloadStats() {
    const stats = downloadCounter.getDownloadStats();
    const statsText = `
        üìä ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶®:
        --------------------------
        ‡¶Æ‡ßã‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°: ${stats.total.toLocaleString('bn-BD')} ‡¶ü‡¶ø
        ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°: ${stats.today.toLocaleString('bn-BD')} ‡¶ü‡¶ø
        ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°‡ßá‡¶∞ ‡¶¶‡¶ø‡¶®: ${stats.maxDate ? new Date(stats.maxDate).toLocaleDateString('bn-BD') : 'N/A'} (${stats.maxCount} ‡¶ü‡¶ø)
    `;
    
    // ‡¶Ü‡¶™‡¶®‡¶ø ‡¶è‡¶ü‡¶ø alert ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶® ‡¶¨‡¶æ UI ‡¶§‡ßá ‡¶∂‡ßã ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®
    const statsDiv = document.createElement('div');
    statsDiv.className = 'fixed bottom-20 left-4 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-xl z-50 max-w-md border border-green-300';
    statsDiv.innerHTML = `
        <div class="flex justify-between items-center mb-3">
            <h3 class="font-bold text-green-600 dark:text-green-400">üìä ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶®</h3>
            <button onclick="this.parentElement.parentElement.remove()" class="text-gray-500 hover:text-gray-700">&times;</button>
        </div>
        <div class="space-y-2 text-sm">
            <div class="flex justify-between">
                <span>‡¶Æ‡ßã‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°:</span>
                <span class="font-bold">${stats.total.toLocaleString('bn-BD')} ‡¶ü‡¶ø</span>
            </div>
            <div class="flex justify-between">
                <span>‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°:</span>
                <span class="font-bold text-green-600">${stats.today.toLocaleString('bn-BD')} ‡¶ü‡¶ø</span>
            </div>
            ${stats.maxDate ? `
            <div class="flex justify-between">
                <span>‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°‡ßá‡¶∞ ‡¶¶‡¶ø‡¶®:</span>
                <span class="font-bold text-blue-600">${new Date(stats.maxDate).toLocaleDateString('bn-BD')} (${stats.maxCount}‡¶ü‡¶ø)</span>
            </div>
            ` : ''}
        </div>
        <div class="mt-3 text-xs text-gray-500">
            * ‡¶°‡ßá‡¶ü‡¶æ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏‡ßá ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§
        </div>
    `;
    document.body.appendChild(statsDiv);
}
</script>
</body>
</html>
